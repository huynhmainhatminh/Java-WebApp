<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{staff/fragments/_header :: common_header('Tạo Giao Dịch Mới')}"></head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">
    <nav th:replace="~{staff/fragments/_header :: navbar}"></nav>
    <aside th:replace="~{staff/fragments/_header :: sidebar('transactions')}"></aside>
    <div class="content-wrapper">
        <section class="content-header"><h1>Tạo Giao Dịch Đổi Pin</h1></section>
        <section class="content">
            <div class="container-fluid">
                <div class="card card-primary">
                    <form th:action="@{/staff/transactions}" th:object="${transaction}" method="post">
                        <input type="hidden" th:field="*{station}" />
                        <div class="card-body">
                            <div class="alert alert-info">Giao dịch tại trạm: <b th:text="${transaction.station?.name}"></b></div>
                            <div class="row">
                                <div class="col-md-6"><div class="form-group"><label>Pin Cũ (Pin khách trả vào):</label>
                                    <select class="form-control" th:field="*{batteryIn}" required>
                                        <option value="">-- Chọn pin cũ --</option>
                                        <option th:each="bat : ${batteries}" th:value="${bat.id}" th:text="${bat.serialNumber} + ' (' + bat.status + ')'"></option>
                                    </select>
                                </div></div>
                                <div class="col-md-6"><div class="form-group"><label>Pin Mới (Pin đưa cho khách):</label>
                                    <select class="form-control" th:field="*{batteryOut}" required>
                                        <option value="">-- Chọn pin mới (chỉ pin Sẵn sàng) --</option>
                                        <option th:each="bat : ${batteries}" th:if="${bat.status == 'AVAILABLE'}" th:value="${bat.id}" th:text="${bat.serialNumber}"></option>
                                    </select>
                                </div></div>
                            </div>
                            <div class="row">
                                <div class="col-md-4"><div class="form-group"><label>Số tiền:</label><input type="number" class="form-control" th:field="*{amount}" required></div></div>
                                <div class="col-md-4"><div class="form-group"><label>Phương thức TT:</label>
                                    <select class="form-control" th:field="*{paymentMethod}" required>
                                        <option value="CASH">Tiền mặt</option>
                                        <option value="CARD">Thẻ</option>
                                        <option value="WALLET">Ví điện tử</option>
                                    </select>
                                </div></div>
                                <div class="col-md-4"><div class="form-group"><label>Trạng thái TT:</label>
                                    <select class="form-control" th:field="*{paymentStatus}">
                                        <option value="COMPLETED">Hoàn thành</option>
                                        <option value="PENDING">Chờ xử lý</option>
                                    </select>
                                </div></div>
                            </div>
                            <div class="form-group"><label>Ghi chú:</label><textarea class="form-control" rows="2" th:field="*{notes}"></textarea></div>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-primary">Xác nhận & Lưu Giao dịch</button>
                            <a th:href="@{/staff/transactions}" class="btn btn-secondary">Hủy</a>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </div>
    <div th:insert="~{admin/fragments/_footer :: footer}"></div>
</div>
<div th:insert="~{admin/fragments/_footer :: common_scripts}"></div>
</body>
</html>